<!DOCTYPE html>
<html lang="en">

<head>
    <base target="_top">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />

    <title>H2V Valparaiso</title>

    <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    <link rel="stylesheet" href="./css/app.css" />
    <link rel="stylesheet" href="./css/topBar.css" />
    <link rel="stylesheet" href="./css/components.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="js/valpo8.js"></script>
    <script src="js/comunas.js"></script>
    <!-- ========= CUENCAS ========= -->
    <script src="./data/cuencas/Cuencas_files/cuenca_050_Costeras Quilimari-Petorca.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_051_Rio Petorca.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_052_Rio Ligua.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_053_Costeras Ligua-Aconcagua.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_054_Rio Aconcagua.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_055_Costeras entre Aconcagua y Maipo.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_056_Islas del Pacifico.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_057_Rio Maipo.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_058_Costeras entre  Maipo y Rapel.js"></script>
    <script src="./data/cuencas/Cuencas_files/cuenca_060_Rio Rapel.js"></script>

    <!-- ========= SUBCUENCAS ========= -->
    <script src="./data/cuencas/Subcuencas_files/subcuenca_500_Costera Quilimari - Petorca.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_510_Rio Petorca Alto (hasta despues Junta Rio Sobrante).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_511_Petorca Medio.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_512_Rio Petorca Bajo (Entre Las Palmas y Desembocadura).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_520_Rio Ligua Alto (Estero Alicahue).js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_521_Rio Ligua Medio (entre Quebrada La Cerrada y Los Angeles).js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_522_Rio Ligua Bajo (Entre Estero Los Angeles y Desembocadura).js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_530_Costeras entre Estero Ligua y Estero Catapilco.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_531_Estero Catapilco.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_532_Costeras entre Estero Catapilco y Rio Aconcagua.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_540_Aconcagua Alto.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_541_Aconcagua Medio.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_542_Aconcagua Bajo.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_550_E. Marga-Marga.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_551_Lago Penuelas.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_552_E. Casablanca y E. San Jeronimo (Incl.).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_553_E. del Rosario (Incl.) a R. Maipo.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_560_Islas de Juan Fernandez.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_561_Isla de Pascua.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_570_Rio Maipo Alto.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_571_Rio Maipo Medio.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_572_R. Mapocho Alto.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_573_Mapocho Bajo.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_574_Rio Maipo Bajo (Entre Rio Mapocho y Desembocadura).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_580_Estero Yali.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_600_Rio Cachapoal Alto (Hasta bajo junta Rio Claro).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_601_Cachapoal Bajo.js"></script>
    <script
        src="./data/cuencas/Subcuencas_files/subcuenca_602_Rio Tinguiririca Alto (Hasta bajo junta Rio Claro).js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_603_Tinguiririca Bajo.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_604_Estero Alhue.js"></script>
    <script src="./data/cuencas/Subcuencas_files/subcuenca_605_Rio Rapel.js"></script>

    <!-- ========= SUBSUBCUENCAS ========= -->
    <!-- <script src="./js/subsubcuencas.js" type="module"></script> -->
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5000_Costeras entre Rios Quilimari y Petorca.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5100_Rio Sobrante.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5101_Rio Pedernal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5110_Rio Petorca Entre Rio Sobrante y Estero Las Palmas.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5111_Estero Las Palmas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5120_Rio Petorca Entre Estero Las Palmas y Desembocadura.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5200_Estero Alicahue.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5210_Rio Ligua ante Quebrada La Cerrada y Estero Los Angeles.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5211_Estero Los Angeles.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5220_Rio Ligua Entre Estero Los Angeles y Bajo Estero La Patagua.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5221_Rio Ligua Entre Estero La Patagua y Desembocadura.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5300_Costera entre Estero Ligua y Estero Catapilco.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5310_Estero Catapilco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5320_Costeras Entre Estero Catapilco y Rio Aconcagua.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5400_Rio Juncal antes junta Estero Juncalillo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5401_Rio Juncal Antes Junta Estero Juncalillo y Junta Rio Blanco.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5402_Rio Blanco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5403_Rio Aconcagua entre Rio Blanco y Rio Colorado.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5404_Rio Colorado antes junta Estero Riecillos.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5405_Estero Riecillos.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5406_Rio Colorado Entre Estero Riecillos y Rio Aconcagua.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5410_Rio Aconcagua entre Rio Colorado y Rio Putaendo.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5411_Estero Pocuro.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5412_Rio Putaendo bajo junta Rio Hidalgo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5413_Rio Putaendo Entre Rio Hidalgo y Bajo Junta Estero Chalaco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5414_Rio Putaendo Entre Estero Chalaco y Rio Aconcagua.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5415_Estero Quilpue.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5416_Estero Seco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5420_Rio Aconcagua Entre Rio Putaendo y Estero Los Loros.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5421_Estero Catemu.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5422_Estero Los Loros.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5423_Rio Aconcagua Entre Estero Los Loros y Estero El Cobre.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5424_Estero El Cobre.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5425_Rio Aconcagua Entre Estero El Cobre y Bajo Quebrada El Ajo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5426_Rio Aconcagua Entre Quebrada El Ajo y Estero Limache.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5427_Estero Limache.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5428_Rio Aconcagua Entre Estero Limache y Desembocadura.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5500_Estero Marga-Marga.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5510_Lago Penuelas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5520_Costeras entre Estero Casablanca y Estero San Jeronimo (Incl.).js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5530_Estero del Rosario (Incl.) a Rio Maipo.js"></script>
    <!-- <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5601_Isla Robinson Crusoe.js"></script> -->
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5602_Isla Alejandro Selkink.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5610_Isla de Pascua.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5700_Rio Maipo bajo junta Rio Negro.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5701_Rio Maipo entre Rio Negro y Rio Volcan.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5702_Rio Volcan.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5703_Rio Yeso.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5704_Rio Maipo entre Rio Volcan y Rio Colorado.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5705_Rio Colorado antes junta Rio Olivares.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5706_Rio Olivares.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5707_Rio Colorado entre Rio Olivares y Rio Maipo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5710_Rio Maipo Entre Estero Colorado y Rio Clarillo.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5711_Rio Clarillo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5712_Rio Maipo Entre Rio Clarillo y Estero Angostura.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5713_Estero Angostura Antes Junta Estero Paine (I).js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5714_Estero Paine.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5715_Estero Angostura Entre Estero Paine (I) y Bajo Junta Estero Paine (II).js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5716_Estero Angostura Entre Estero Paine (II) y Rio Maipo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5717_Rio Maipo Entre Estero Angostura y Rio Mapocho.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5720_Rio Molina.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5721_Rio San Francisco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5722_Rio Mapocho Entre Rio San Francisco y Bajo Junta Estero Arrayan.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5723_Rio Mapocho entre Estero Arrayan y bajo unta Estero de Las Rosas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5730_Rio Mapocho Entre Estero de Las Rosas y Estero Lampa y Bajo Zanjon de la Aguada.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5731_Estero Quilapilun Bajo Junta Estero la Margarita.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5732_Estero Chacabuco Entre Estero La Margarita y Estero Tiltil.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5733_Estero Tiltil.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5734_Estero Lampa Entre Estero Tiltil y Estero Colina.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5735_Estero Colina.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5736_Estero Lampa Entre Estero Colina y Rio Mapocho.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5737_Rio Mapocho entre Zanjon de la Aguada y Rio Maipo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5740_Rio Maipo Entre Rio Mapocho y Estero Puangue.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5741_Estero Puangue Antes Estero Caren.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5742_Estero Puangue Entre Antes Estero Caren y Antes Estero Zapata.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5743_Estero Puangue Entre Antes Estero Zapata y Estero Sin Nombre.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5744_Estero Puangue Entre Estero Sin Nombre y Bajo Junta Estero Amestica.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5745_Estero Puangue Entre Estero Amestica y Bajo Junta Estero de los Mayos.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5746_Estero Puangue Entre Estero de Los Mayos y Rio Maipo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5747_Rio Maipo entre Estero Puangue y bajo junta Estero Popeta.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_5748_Rio Maipo Entre Estero Popeta y Desembocadura.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_5800_Estero Yali.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6000_Rio Cachapoal antes junta Rio Cortaderal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6001_Rio Cortaderal en desembocadura Laguna Pejerreyes.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6002_Rio Cotaderal Entre Laguna Pejerreyes y Rio Cachapoal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6003_Rio Cachapoal entre Rio Cortaderal y Rio Pangal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6004_Rio Pangal (Rio Paredones) en junta con Rio Blanco.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6005_Rio Blanco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6006_Rio Pangal entre Rio Blanco y Rio Cachapoal.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6007_Estero Coya.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6008_Rio Cachapoal entre Rio Pangal y Rio Claro.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6009_Rio Claro.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6010_Rio Cachapoal entre Rio Claro y Estero Las Cadenas.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6011_Estero Las Cadenas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6012_Rio Cachapoal Entre Estero Las Cadenas y Rio Claro (de Rengo).js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6013_Rio Claro hasta Estero Tipaume.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6014_Estero Tipaume.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6015_Rio Claro Entre Estero Tipaume y Rio Cachapoal.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6016_Estero Zamorano hasta Estero Rigolemu.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6017_Estero Rigolemu.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6018_Estero Zamorano Entre Estero Rigolemu y Rio Cachapoal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6019_Estero Cachapoal entre Estero Claro y Central Rapel.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6020_Rio Tinguiririca hasta bajo junta Rio Las Damas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6021_Rio Tinguiririca Entre Rio Las Damas y Rio del Azufre.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6022_Rio Portillo.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6023_Rio Azufre hasta Rio Portillo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6024_Rio Azufre entre Rio Portillo y Rio Tinguiririca.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6025_Rio Tinguiririca entre Rio Azufre y Rio Clarillo.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6026_Rio Clarillo.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6027_Rio Claro.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6028_Rio Tinguiririca Entre Rio Clarillo y Bajo Junta Rio Claro.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6030_Rio Tinguiririca entre Rio Claro y Lo Moscoso.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6031_Rio Tinguiririca Entre Lo Moscoso y Estero Chimbarongo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6032_Estero Chimbarongo Hasta Bajo Estero Pichihuinco.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6033_Estero Chimbarongo Entre Estero Pichihuinco y Embalse Convento Viejo.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6034_Estero Chimbarongo Entre Arriba Embalse Convento Viejo y Rio Tinguiririca.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6035_Rio Tinguiririca Entre Estero Chimbarongo y Estero Calleuque.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6036_Estero Calleuque (de las Toscas) Hasta Bajo Junta Esteros Lima y del Zapal.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6037_Estero Calleuque (de las Toscas) Entre Estero del Zapal y Rio Tinguiririca.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6038_Rio Tinguiririca Entre Estero Calleuque y Embalse Rapel.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6040_Estero Alhue hasta Estero de Piche.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6041_Estero Alhue Entre Arriba Estero de Pichi y Estero Caren.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6042_Estero Caren.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6043_Estero Alhue Entre Estero Caren y Estero Las Palmas (Embalse Rapel).js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6044_Estero Las Palmas.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6045_Estero Alhue Entre Estero Las Palmas y Antiguo Lecho Rio Rapel.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6050_Estero Cadenas hasta bajo Estero Chequen.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6051_Estero Cadenas Entre Estero Chequen y Embalse Rapel.js"></script>
    <script src="data/cuencas/Subsubcuencas_files/subsubcuenca_6052_Estero San Miguel.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6053_Embalse Central Rapel hasta Estero Alhue.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6054_Embalse Central Rapel Entre Brazo Estero Alhue y Muro Central Rapel.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6055_Rio Rapel Entre Muro Embalse Central Rapel y Bajo Estero Corneche.js"></script>
    <script
        src="data/cuencas/Subsubcuencas_files/subsubcuenca_6056_Rio Rapel Entre Estero Corneche y Desembocadura.js"></script>
    <script src="js/desalinizadoras.js"></script>
    <script src="data/ptas.js"></script>
    <script src="js/app.js" defer></script>

</head>

<body>
    <div id="spinner-container">
        <div id="spinner"></div>
    </div>

    <div id="top-bar">
        <img src="img/logo_h2v.webp" height="120" class="logo">
        <img src="img/logo_muni.webp" width="160pt">
        <img src="img/logo_pucv_w.webp" width="160pt">
        <img src="img/logo_corfo_w.png" width="160pt">
        <img src="img/logo_DPS_w.png" width="160pt">
    </div>
    <div id="sideMenu-left" class="menu-floating" data-visible>
        <main>
            <section id="section-opciones">
                <header data-target="menu-opciones" class="btn">
                    <img src="./img/icon/options.png" width="32" alt="">
                    <h3>Comunas</h3>
                </header>
            </section>
            <section id="menu-indicadores">
                <header data-target="section-indicadores" class="btn">
                    <img src="./img/icon/graph.png" width="32" alt="">
                    <h3>Indicadores</h3>
                </header>
            </section>

            <section id="section-hidricos">
                <header data-target='menu-hidrico' class="btn">
                    <img src="./img/icon/agua.png" width="32" alt="">
                    <h3>Recursos Hídricos</h3>
                </header>
            </section>
            <section id="menu-detalle">
                <header data-target="section-detalle" class="btn">
                    <img src="./img/icon/information.png" width="32" alt="">
                    <h3>Descripción Indicadores</h3>
                </header>
            </section>
            <section id="menu-manual">
                <header data-target="section-manual" class="btn link inverse-color">
                    <a href='/manual' target="_blank">
                        <img src="./img/icon/manual-white.png" width="32" alt="">
                    </a>
                    <h3>Manual de Usuario</h3>
                </header>
            </section>
        </main>
    </div>

    <div id="alert-notMeet">
        Área no cumple con los requisitos
    </div>
    <div id="coordDisplay">
        Coordenadas: <span id="coordValue"> </span>
    </div>
    <section id="menu-hidrico" class="menu-floating">
        <header class="title">
            <h3>Recursos Hídricos</h3>
            <button data-target="menu-hidrico" class="btn-close">&times;</button>
        </header>
        <main>
            <div>
                <!-- <header> -->
                <!--     <input type="checkbox" id="toggle-cuencas" name="toggle-cuencas" -->
                <!--         onchange="handleLayerGroupToggle(this)"> -->
                <!--     <div data-target="menu-cuencas" class='btn'> -->
                <!--         <label>Cuencas</label> -->
                <!--         <button type="button" class="btn-accordion"></button> -->
                <!--     </div> -->
                <!-- </header> -->
                <!-- <form id="menu-cuencas" class="accordion" autocomplete="off"> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-quilimariPetorca" name="toggle-quilimariPetorca" -->
                <!--             onchange="toggleCuenca(this, '050')" data-cuenca="050" checked> -->
                <!--         <label for="toggle-quilimariPetorca">Costeras Quilimari-Petorca</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-petorca" name="toggle-petorca" -->
                <!--             onchange="toggleCuenca(this, '051')" data-cuenca="051" checked> -->
                <!--         <label for="toggle-petorca">Río petorca</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-ligua" name="toggle-ligua" -->
                <!--             onchange="toggleCuenca(this, '052')" data-cuenca="052" checked> -->
                <!--         <label for="toggle-ligua">Rio Ligua</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-liguaAconcagua" name="toggle-liguaAconcagua" -->
                <!--             onchange="toggleCuenca(this, '053')" data-cuenca="053" checked> -->
                <!--         <label for="toggle-liguaAconcagua">Costeras Ligua-Aconcagua</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-quilimari" name="toggle-quilimari" -->
                <!--             onchange="toggleCuenca(this, '054')" data-cuenca="054" checked> -->
                <!--         <label for="toggle-quilimari">Río Aconcagua</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-AconcaguaMaipo" name="toggle-AconcaguaMaipo" -->
                <!--             onchange="toggleCuenca(this, '055')" data-cuenca="055" checked> -->
                <!--         <label for="toggle-AconcaguaMaipo">Costeras Aconcagua-Maipo</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-pacifico" name="toggle-pacifico" -->
                <!--             onchange="toggleCuenca(this, '056')" data-cuenca="056" checked disabled> -->
                <!--         <label for="toggle-pacifico">Islas del Pacífico</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-Maipo" name="toggle-Maipo" -->
                <!--             onchange="toggleCuenca(this, '057')" data-cuenca="057" checked> -->
                <!--         <label for="toggle-Maipo">Río Maipo</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-MaipoRapel" name="toggle-MaipoRapel" -->
                <!--             onchange="toggleCuenca(this, '058')" data-cuenca="058" checked> -->
                <!--         <label for="toggle-MaipoRapel">Costeras Maipo-Rapel</label> -->
                <!--     </div> -->
                <!--     <div> -->
                <!--         <input type="checkbox" id="toggle-Rapel" name="toggle-Rapel" -->
                <!--             onchange="toggleCuenca(this, '060')" data-cuenca="060" checked> -->
                <!--         <label for="toggle-Rapel">Río Rapel</label> -->
                <!--     </div> -->
                <!-- </form> -->
                <div>
                    <input type="checkbox" id="toggle-cuencas" name="toggle-cuencas"
                        onchange="handleLayerGroupToggle(this)">
                    <label for="toggle-cuencas">Cuencas</label>
                </div>
                <div>
                    <input type="checkbox" id="toggle-subcuencas" name="toggle-subcuencas"
                        onchange="handleLayerGroupToggle(this)">
                    <label for="toggle-subcuencas">Subcuencas</label>
                </div>
                <div>
                    <input type="checkbox" id="toggle-subsubcuencas" name="toggle-subsubcuencas"
                        onchange="handleLayerGroupToggle(this)">
                    <label for="toggle-subsubcuencas">Subsubcuencas</label>
                </div>
                <div>
                    <input type="checkbox" id="toggle-desalination" name="toggle-desalination">
                    <label for="toggle-desalination">Desalinizadoras</label>
                </div>
                <div>
                    <input type="checkbox" id="toggle-ptas" name="toggle-ptas">
                    <label for="toggle-ptas">Plantas de Tratamiento de Agua</label>
                </div>
            </div>
        </main>
    </section>
    <section id="menu-opciones" class="menu-floating">
        <header class="title">
            <h3>Comunas</h3>
            <button data-target="menu-opciones" class="btn-close">&times;</button>
        </header>
        <main>
            <div>
                <input type="checkbox" id="toggle-communes" name="toggle-communes" checked>
                <label for="toggle-communes">Comunas</label>
            </div>
            <div>
                <input type="checkbox" id="toggle-limitCommunes" name="toggle-limitCommunes">
                <label for="toggle-limitCommunes">Límite de comunas</label>
            </div>
        </main>
    </section>
    <section id="section-indicadores" class="menu-floating">
        <header class="title">
            <h3>Indicadores</h3>
            <button data-target="section-indicadores" class="btn-close">&times;</button>
        </header>
        <main>
            <section id="section-socioAmbiental">
                <header data-target="menu-socioAmbiental" class="btn" data-active>
                    <h3>Socio-ambientales</h3>
                    <button type="button" class="btn-accordion"></button>
                </header>
                <main id="menu-socioAmbiental" class="accordion" data-visible>
                    <div>
                        Dist. SNASPE <span class="unit">Km</span>
                        <button data-target="pop-snaspe" class="btn-popover">&quest;</button>
                        <span id="valor-snaspe">-</span>
                        <div id="pop-snaspe" class="pop-info">
                            Distancia a Sistema Nacional de Áreas Silvestres Protegidas del Estado (<a
                                href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley 20.283</a>)
                        </div>

                    </div>
                    <div>
                        Dist. AVE<span class="unit">Km</span>

                        <button data-target="pop-ave" class="btn-popover">&quest;</button>
                        <span id="valor-ave">-</span>
                        <div id="pop-ave" class="pop-info">
                            Distancia a Áreas con Valor Ecológico (<a
                                href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley
                                20.283</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Humedal<span class="unit">Km</span>

                        <button data-target="pop-humedal" class="btn-popover">&quest;</button>
                        <span id="valor-humedal">-</span>
                        <div id="pop-humedal" class="pop-info">
                            Distancia a Sitios RAMSAR (Humedal) (<ac
                                href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley
                                20.283</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Patrimonio Mundial<span class="unit">Km</span>

                        <button data-target="pop-patrimonioMundial" class="btn-popover">&quest;</button>
                        <span id="valor-patrimonioMundial">-</span>
                        <div id="pop-patrimonioMundial" class="pop-info">
                            Distancia a Sitios del Patrimonio Mundial (<a
                                href="https://www.bcn.cl/leychile/navegar?idNorma=28892">Ley
                                17.288</a>; <a href="https://whc.unesco.org/en/conventiontext/">UNESCO 1972</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Monumento Nacional<span class="unit">Km</span>

                        <button data-target="pop-monumentoNacional" class="btn-popover">&quest;</button>
                        <span id="valor-monumentoNacional">-</span>
                        <div id="pop-monumentoNacional" class="pop-info">
                            Distancia a Monumentos Nacionales (<a
                                href="https://www.bcn.cl/leychile/navegar?idNorma=28892">Ley
                                17.288</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Santuario Natural<span class="unit">Km</span>

                        <button data-target="pop-santuarioNatural" class="btn-popover">&quest;</button>
                        <span id="valor-santuarioNatural">-</span>
                        <div id="pop-santuarioNatural" class="pop-info">
                            Distancia a Sitios Santuarios de la Naturaleza (<a
                                href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley 20.283</a>)
                        </div>
                    </div>
                </main>
            </section>
            <section id="section-tecnico">
                <header data-target="menu-tecnico" class="btn" data-active>
                    <h3>Técnicos</h3>
                    <button type="button" class="btn-accordion"></button>
                </header>
                <main id="menu-tecnico" class="accordion" data-visible>
                    <div>
                        Dist. Red Vial<span class="unit">Km</span>

                        <button data-target="pop-redVial" class="btn-popover">&quest;</button>
                        <span id="valor-redVial">-</span>
                        <div id="pop-redVial" class="pop-info">
                            Distancia a Red Vial o Red de Carreteras (<a
                                href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al., 2023</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Costa<span class="unit">Km</span>

                        <button data-target="pop-costa" class="btn-popover">&quest;</button>
                        <span id="valor-costa">-</span>
                        <div id="pop-costa" class="pop-info">
                            Distancia a la Costa (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al., 2023</a>)
                        </div>

                    </div>
                    <div>
                        Dist. Terminal<span class="unit">Km</span>

                        <button data-target="pop-terminal" class="btn-popover">&quest;</button>
                        <span id="valor-terminal">-</span>
                        <div id="pop-terminal" class="pop-info">
                            Distancia a Terminales Marítimos (Puertos) (<a
                                href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al., 2023</a>)
                        </div>

                    </div>

                    <div>
                        Dist. Población<span class="unit">Km</span>
                        <button data-target="pop-poblacion" class="btn-popover">&quest;</button>
                        <span id="valor-poblacion">-</span>
                        <div id="pop-poblacion" class="pop-info">
                            Distancia a Áreas Pobladas (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al.,
                                2023</a>)
                        </div>

                    </div>
                    <div>
                        RTI<span class="unit">m</span>
                        <button data-target="pop-rti" class="btn-popover">&quest;</button>
                        <span id="valor-rti">-</span>
                        <div id="pop-rti" class="pop-info">
                            Rugosidad del Terreno (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al., 2023</a>)
                        </div>

                    </div>
                    <div>
                        PVOUT <span class="unit">kWh-Año/kWp</span>
                        <button data-target="pop-pvout" class="btn-popover">&quest;</button>
                        <span id="valor-pvout">-</span>
                        <div id="pop-pvout" class="pop-info">
                            Potencial Fotovoltaico o Energía útil anual por unidad de potencia (<a
                                href="https://globalsolaratlas.info/download/chile">Global Solar Atlas</a>; <a
                                href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San Martin et al., 2023</a>)
                        </div>
                    </div>
                    <div>
                        Potencia Eólica <span class="unit">MW</span>
                        <button data-target="pop-potenciaEolica" class="btn-popover">&quest;</button>
                        <span id="valor-potenciaEolica">-</span>
                        <div id="pop-potenciaEolica" class="pop-info">
                            Potencial Energético Eólico (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                                Martin et al.,
                                2023</a>)
                        </div>
                    </div>
                    <div>
                        Hidrógeno<span class="unit">kgH<sub>2</sub>-Año/kWp</span>
                        <button data-target="pop-hidrogeno" class="btn-popover">&quest;</button>
                        <span id="valor-hidrogeno">-</span>
                        <div id="pop-hidrogeno" class="pop-info">
                            Potencial de Generación de Hidrógeno Verde
                        </div>
                    </div>
                    <div>
                        Hidrógeno<span class="unit">kgH<sub>2</sub>-Año/m<sup>2</sup></span>
                        <span id="valor-hidrogenoM2">-</span>
                    </div>
                </main>
            </section>

        </main>

    </section>
    <section id="section-detalle" class="menu-floating">
        <header class="title">
            <h3>Descripción Indicadores</h3>
            <button data-target="section-detalle" class="btn-close">&times;</button>
        </header>
        <div id="tableDiv">
            <table>
                <thead>
                    <tr>
                        <th>Indicador</th>
                        <th>Detalles</th>
                        <th style="text-align: center;">Tipo</th>
                        <th style="text-align: center;">Unidad</th>
                    </tr>
                </thead>
                <tr>
                    <td>Dist. SNASPE</td>
                    <td>Distancia a Sistema Nacional de Áreas Silvestres Protegidas del Estado (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley 20.283</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>
                <tr>
                    <td>Dist. AVE</td>
                    <td>Distancia a Áreas con Valor Ecológico (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley
                            20.283</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>
                <tr>
                    <td>DIST. Humedal</td>
                    <td>Distancia a Sitios RAMSAR (Humedal) (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley
                            20.283</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>
                <tr>
                    <td>Dist. Patrimonio mundial</td>
                    <td>Distancia a Sitios del Patrimonio Mundial (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=28892">Ley
                            17.288</a>; <a href="https://whc.unesco.org/en/conventiontext/">UNESCO 1972</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>
                <tr>
                    <td>Dist. Monumento nacional</td>
                    <td>Distancia a Monumentos Nacionales (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=28892">Ley
                            17.288</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>
                <tr>
                    <td>Dist. Santuario natural</td>
                    <td>Distancia a Sitios Santuarios de la Naturaleza (<a
                            href="https://www.bcn.cl/leychile/navegar?idNorma=274894">Ley 20.283</a>)</td>
                    <td style="text-align: center;">Socio-ambiental</td>
                    <td style="text-align: center;">km</td>
                </tr>

                <tr>
                    <td>Dist. Red vial</td>
                    <td>Distancia a Red Vial o Red de Carreteras (<a
                            href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                            Martin et al., 2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">km</td>
                </tr>

                <tr>
                    <td>Dist. Costa</td>
                    <td> Distancia a la Costa (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                            Martin et al., 2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">km</td>
                </tr>

                <tr>
                    <td>Dist. Terminal</td>
                    <td>Distancia a Terminales Marítimas (Puertos) (<a
                            href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                            Martin et al., 2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">km</td>
                </tr>

                <tr>
                    <td>Dist. Poblacion</td>
                    <td>Distancia a Áreas Pobladas (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San Martin
                            et al.,
                            2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">km</td>
                </tr>

                <tr>
                    <td>RTI</td>
                    <td>Rugosidad del Terreno (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San
                            Martin et al., 2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">m</td>
                </tr>
                <tr>
                    <td>PVOUT</td>
                    <td>Potencial Fotovoltaico o Energía útil anual por unidad de potencia (<a
                            href="https://globalsolaratlas.info/download/chile">Global Solar Atlas</a>; <a
                            href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San Martin et al., 2023</a>)
                    </td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">kWh-Año/kWp</td>
                </tr>
                <tr>
                    <td>Pot. Eólica</td>
                    <td>Potencia Energético Eólico (<a href="https://doi.org/10.1016/j.ijhydene.2023.10.013">San Martin
                            et al.,
                            2023</a>)</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">MW</td>
                </tr>
                <tr>
                    <td>Hidrógeno</td>
                    <td>Potencial de Generación de Hidrógeno Verde</td>
                    <td style="text-align: center;">Técnica</td>
                    <td style="text-align: center;">kgH2/kW <br>kgH2/m^2</td>
                </tr>
            </table>
        </div>
    </section>

    <section id="section-ptas" class="menu-floating">
        <header class="title">
            <h3>Planta de Tratamiento</h3>
            <button id="btn-closePtas" class="btn-close" data-target="section-ptas">&times;</button>
        </header>
        <main>
            <div>
                Nombre
                <span id="ptas-name">-</span>
            </div>
            <div>
                Tecnología
                <span id="ptas-technology">-</span>
            </div>
            <div>
                Caudal
                <span id="ptas-flowRate">-</span>
                <span class="unit">L/s</span>
            </div>
        </main>
    </section>

    <section id="section-desaladoras" class="menu-floating">
        <header class="title">
            <h3>Desalinizadora</h3>
            <button id="btn-closeDesaladoras" class="btn-close" data-target="section-desaladoras">&times;</button>
        </header>
        <main>
            <div>
                Nombre
                <select id="select-desaladoras">
                    <option value="Desalinizadora Petorca">Desalinizadora Petorca</option>
                    <option value="Unidad 3 Ventanas">Unidad 3 Ventanas</option>
                    <option value="Unidad 4 Ventanas">Unidad 4 Ventanas</option>
                    <option value="Aconcagua">Aconcagua</option>
                </select>
            </div>
            <div>
                Estado
                <span id="desaladora-status">-</span>
            </div>
            <div>
                Capacidad
                <span id="desaladora-capacity">-</span>
                <span id="desaladora-unit" class="unit"></span>
            </div>
            <div>
                Uso
                <span id="desaladora-use">-</span>
            </div>
            <div>
                Propietario
                <span id="desaladora-owner">-</span>
            </div>
        </main>
    </section>
    <section id="section-legend">
        <div class="legend-container">
            <div class="box black"></div>
            <div class="legend-text">Zonas no aptas</div>
        </div>
        <div class="legend-container">
            <div class="box green"></div>
            <div class="legend-text">Zonas aptas</div>
        </div>
    </section>
    <div id="map-container">
        <div id="map" style="width: 100%; height: 100%; z-index: 1; position: relative;"></div>
        <script>
            const map = L.map('map', {
                center: [-33.0309126, -71.0634993],
                zoom: 10,
                zoomControl: false
            });
            const tiles = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                maxZoom: 19,
                attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
            }).addTo(map);

            L.control.zoom({
                position: 'bottomright'
            }).addTo(map);

            // ========= Limite de comunas =========
            function getRandomHexColor() {
                const randomColor = Math.floor(Math.random() * 16777215);
                let hexColor = randomColor.toString(16);
                while (hexColor.length < 6) {
                    hexColor = "0" + hexColor;
                }
                return "#" + hexColor;
            }

            let communesMap = {};
            const displayLimitcommunes = () => {
                for (const communeName in comunas) {
                    if (comunas.hasOwnProperty(communeName)) {
                        const communeData = comunas[communeName];
                        const coor = communeData.Coordinates;

                        const polygon = L.polygon(coor).addTo(map);
                        const clr = getRandomHexColor();
                        polygon.setStyle({fillColor: clr, color: clr, weight: 1, opacity: 1, fillOpacity: 0.25});
                        communesMap[communeName] = polygon;
                        polygon.name = communeName;
                        polygon.bindPopup(`<b>Comuna:</b> ${communeName}`);
                        const formCuencas = document.getElementById('menu-cuencas');
                        const cuencaCheckboxes = formCuencas ? formCuencas.querySelectorAll('input[type="checkbox"][data-cuenca]') : [];
                        deactivateCuencasLayer(cuencaCheckboxes, formCuencas);
                        deactivateSubcuencasLayer();
                        deactivateSubsubcuencasLayer();
                    }
                }
            }

            function removeLimitCommunes() {
                for (var key in communesMap) {
                    if (communesMap.hasOwnProperty(key)) {
                        map.removeLayer(communesMap[key]);
                        delete communesMap[key];
                    }
                }
            }

            // ========= Cuencas =========
            let cuencasMap = {};
            const cuencas = [
                cuenca50,
                cuenca51,
                cuenca52,
                cuenca53,
                cuenca54,
                cuenca55,
                //cuenca56, 
                cuenca57,
                cuenca58,
                cuenca60,
            ];



            // ========= Subcuencas =========
            let subcuencasMap = {};
            const subcuencas = [
                subcuenca500,
                subcuenca510,
                subcuenca511,
                subcuenca512,
                subcuenca520,
                subcuenca521,
                subcuenca522,
                subcuenca530,
                subcuenca531,
                subcuenca532,
                subcuenca540,
                subcuenca541,
                subcuenca542,
                subcuenca550,
                subcuenca551,
                subcuenca552,
                subcuenca553,
                subcuenca560,
                subcuenca561,
                subcuenca570,
                subcuenca571,
                subcuenca572,
                subcuenca573,
                subcuenca574,
                subcuenca580,
                subcuenca600,
                subcuenca601,
                subcuenca602,
                subcuenca603,
                subcuenca604,
                subcuenca605];
            const loadCuencas = () => {
                cuencas.forEach((c) => {
                    const coor = c.features[0].geometry.rings;
                    const polygon = L.polygon(coor);
                    const clr = getRandomHexColor();
                    polygon.setStyle({fillColor: clr, color: clr, weight: 1, opacity: 1, fillOpacity: 0.25});
                    if (c.features[0].attributes && c.features[0].attributes.COD_CUEN) {
                        cuencasMap[c.features[0].attributes.COD_CUEN] = polygon;
                        polygon.bindPopup(`${c.features[0].attributes.NOM_CUEN}`);
                    } else {
                        console.warn("Cuenca missing 'COD_CUEN' attribute:", c);
                    }
                });
            }
            const loadSubcuencas = () => {
                subcuencas.forEach((sc) => {
                    const coor = sc.features[0].geometry.rings;
                    const polygon = L.polygon(coor);

                    const clr = getRandomHexColor();
                    polygon.setStyle({fillColor: clr, color: clr, weight: 1, opacity: 1, fillOpacity: 0.25});

                    if (sc.features[0].attributes && sc.features[0].attributes.COD_CUEN && sc.features[0].attributes.COD_SUBC) {
                        polygon.cuenca = sc.features[0].attributes.COD_CUEN;
                        subcuencasMap[sc.features[0].attributes.COD_SUBC] = polygon;
                        const cuencaName = getCuencaNameByCode(cuencas, sc.features[0].attributes.COD_CUEN);
                        polygon.bindPopup(`<b>Subcuenca:</b> ${sc.features[0].attributes.NOM_SUBC}<br><b>Cuenca:</b> ${cuencaName}`); // Add popup
                    } else {
                        console.warn("Subcuenca missing 'COD_CUEN' or 'COD_SUBC' attribute:", sc);
                    }
                });
            };
            const loadSubsubcuencas = () => {
                subsubcuencas.forEach((ssc) => {
                    const coor = ssc.features[0].geometry.rings;
                    const polygon = L.polygon(coor);
                    const clr = getRandomHexColor();
                    polygon.setStyle({fillColor: clr, color: clr, weight: 1, opacity: 1, fillOpacity: 0.25});

                    if (ssc.features[0].attributes) {
                        polygon.cuenca = ssc.features[0].attributes.COD_CUEN;
                        polygon.name = ssc.features[0].attributes.NOM_SSUBC;
                        const cuencaName = getCuencaNameByCode(cuencas, ssc.features[0].attributes.COD_CUEN)
                        subsubcuencasMap[ssc.features[0].attributes.COD_SSUBC] = polygon;
                        polygon.bindPopup(`<b>Subsubcuenca:</b> ${ssc.features[0].attributes.NOM_SSUBC || ssc.features[0].attributes.COD_SSUBC}<br><b>Cuenca:</b> ${cuencaName}`);
                    } else {
                        console.warn("Subsubcuenca missing attributes:", ssc);
                    }

                    polygon.on('click', (e) => {
                        console.log(e.target.name);
                    });

                });
            };
            function getCuencaNameByCode(dataArray, codCuenca) {
                for (const item of dataArray) {
                    if (item.features && item.features.length > 0) {
                        for (const feature of item.features) {
                            if (feature.attributes && feature.attributes.COD_CUEN === codCuenca) {
                                return feature.attributes.NOM_CUEN;
                            }
                        }
                    }
                }
                return null; // Return null if no matching COD_CUEN is found
            }
            // Variable para almacenar el último estado de los checkboxes individuales de cuencas
            let lastCuencasState = {};

            const handleLayerGroupToggle = (clickedCheckbox) => {
                const mainLayerToggles = ['toggle-cuencas', 'toggle-subcuencas', 'toggle-subsubcuencas'];
                const formCuencas = document.getElementById('menu-cuencas');
                const cuencaCheckboxes = formCuencas ? formCuencas.querySelectorAll('input[type="checkbox"][data-cuenca]') : [];

                // 1. Desactivar los otros checkboxes principales del grupo
                mainLayerToggles.forEach(id => {
                    const checkbox = document.getElementById(id);
                    if (checkbox && checkbox.id !== clickedCheckbox.id) {
                        // Solo desmarca si está marcado para evitar llamadas recursivas innecesarias
                        if (checkbox.checked) {
                            checkbox.checked = false;
                            // Si desmarcamos programáticamente, necesitamos disparar su lógica de desactivación.
                            // Es CRUCIAL pasar los argumentos correctos aquí.
                            if (checkbox.id === 'toggle-cuencas') {
                                deactivateCuencasLayer(cuencaCheckboxes, formCuencas); // <-- PASANDO ARGUMENTOS
                            } else if (checkbox.id === 'toggle-subcuencas') {
                                deactivateSubcuencasLayer();
                            } else if (checkbox.id === 'toggle-subsubcuencas') {
                                deactivateSubsubcuencasLayer();
                            }
                        }
                    }
                });

                // 2. Ejecutar la lógica específica para el checkbox clickeado/cambiado
                if (clickedCheckbox.id === 'toggle-cuencas') {
                    if (clickedCheckbox.checked) {
                        activateCuencasLayer(cuencaCheckboxes, formCuencas);
                    } else {
                        deactivateCuencasLayer(cuencaCheckboxes, formCuencas);
                    }
                } else if (clickedCheckbox.id === 'toggle-subcuencas') {
                    if (clickedCheckbox.checked) {
                        activateSubcuencasLayer();
                    } else {
                        deactivateSubcuencasLayer();
                    }
                } else if (clickedCheckbox.id === 'toggle-subsubcuencas') {
                    if (clickedCheckbox.checked) {
                        activateSubsubcuencasLayer();
                    } else {
                        deactivateSubsubcuencasLayer();
                    }
                }

                // Lógica adicional para los otros checkboxes no relacionados (ej. límite de comunas)
                if (clickedCheckbox.checked) {
                    const toggleLimitCommunes = document.getElementById('toggle-limitCommunes');
                    if (toggleLimitCommunes && toggleLimitCommunes.checked) {
                        toggleLimitCommunes.checked = false;
                        if (typeof removeLimitCommunes === 'function') {
                            removeLimitCommunes();
                        }
                    }
                }
            };

            // --- Funciones Auxiliares para Activar/Desactivar Capas Específicas ---

            const activateCuencasLayer = (cuencaCheckboxes, formCuencas) => {
                if (Object.keys(lastCuencasState).length === 0 || Object.values(lastCuencasState).every(val => !val)) {
                    cuencaCheckboxes.forEach(cb => {
                        if (!cb.disabled) {
                            cb.checked = true;
                        }
                    });
                } else {
                    cuencaCheckboxes.forEach(cb => {
                        if (!cb.disabled) {
                            cb.checked = lastCuencasState[cb.id] || false;
                        }
                    });
                }
                for (let key in cuencasMap) {
                    cuencasMap[key].addTo(map);
                }
            };

            const deactivateCuencasLayer = (cuencaCheckboxes, formCuencas) => {
                // Guardar el estado actual de los sub-cuencas antes de desmarcarlos
                cuencaCheckboxes.forEach(cb => {
                    lastCuencasState[cb.id] = cb.checked;
                    cb.checked = false;
                    // Remover la capa correspondiente del mapa
                    const cuencaKey = cb.getAttribute('data-cuenca');
                    if (cuencasMap[cuencaKey] && map.hasLayer(cuencasMap[cuencaKey])) {
                        map.removeLayer(cuencasMap[cuencaKey]);
                    }
                });
                for (let key in cuencasMap) {
                    map.removeLayer(cuencasMap[key]);
                }
            };

            const activateSubcuencasLayer = () => {
                for (let key in subcuencasMap) {
                    if (map && subcuencasMap[key]) {
                        subcuencasMap[key].addTo(map);
                    }
                }
            };

            const deactivateSubcuencasLayer = () => {
                for (let key in subcuencasMap) {
                    if (map && map.hasLayer(subcuencasMap[key])) {
                        map.removeLayer(subcuencasMap[key]);
                    }
                }
            };

            const activateSubsubcuencasLayer = () => {
                for (let key in subsubcuencasMap) {
                    if (map && subsubcuencasMap[key]) {
                        subsubcuencasMap[key].addTo(map);
                    }
                }
            };

            const deactivateSubsubcuencasLayer = () => {
                for (let key in subsubcuencasMap) {
                    if (map && map.hasLayer(subsubcuencasMap[key])) {
                        map.removeLayer(subsubcuencasMap[key]);
                    }
                }
            };


            // --- Asignación de Event Listeners ---

            document.addEventListener('DOMContentLoaded', () => {
                const toggleCuencas = document.getElementById('toggle-cuencas');
                const toggleSubcuencas = document.getElementById('toggle-subcuencas');
                const toggleSubsubcuencas = document.getElementById('toggle-subsubcuencas');
                const formCuencas = document.getElementById('menu-cuencas');
                const cuencaCheckboxes = formCuencas ? formCuencas.querySelectorAll('input[type="checkbox"][data-cuenca]') : [];

                // Asignar el manejador central a los checkboxes principales
                if (toggleCuencas) {
                    toggleCuencas.addEventListener('change', () => handleLayerGroupToggle(toggleCuencas));
                }
                if (toggleSubcuencas) {
                    toggleSubcuencas.addEventListener('change', () => handleLayerGroupToggle(toggleSubcuencas));
                }
                if (toggleSubsubcuencas) {
                    toggleSubsubcuencas.addEventListener('change', () => handleLayerGroupToggle(toggleSubsubcuencas));
                }

                // Manejador para los checkboxes individuales dentro del formulario de cuencas
                cuencaCheckboxes.forEach(cb => {
                    cb.addEventListener('change', () => {
                        lastCuencasState[cb.id] = cb.checked; // Actualiza el estado guardado

                        // Agrega o remueve la capa individual de la cuenca
                        const cuencaKey = cb.getAttribute('data-cuenca');
                        if (cuencasMap[cuencaKey]) { // Asegúrate de que la capa existe
                            if (cb.checked) {
                                cuencasMap[cuencaKey].addTo(map);
                            } else {
                                map.removeLayer(cuencasMap[cuencaKey]);
                            }
                        }

                        // Asegura que 'toggle-cuencas' se marque/desmarque según el estado de las cuencas individuales
                        const anyCuencaChecked = Array.from(cuencaCheckboxes).some(cb => cb.checked);
                        if (toggleCuencas && toggleCuencas.checked !== anyCuencaChecked) {
                            toggleCuencas.checked = anyCuencaChecked;
                            // Si toggle-cuencas se desmarca porque todas las sub-cuencas se desmarcaron
                            if (!anyCuencaChecked && formCuencas) {
                                formCuencas.style.display = 'none'; // Oculta el formulario si ninguna cuenca está marcada
                            } else if (anyCuencaChecked && formCuencas) {
                                formCuencas.style.display = 'block'; // Muestra el formulario si al menos una está marcada
                            }
                        }

                        // Si se marca una subcuenca individual, desactiva Subcuencas y Subsubcuencas
                        if (cb.checked) {
                            if (toggleSubcuencas && toggleSubcuencas.checked) {
                                toggleSubcuencas.checked = false;
                                deactivateSubcuencasLayer();
                            }
                            if (toggleSubsubcuencas && toggleSubsubcuencas.checked) {
                                toggleSubsubcuencas.checked = false;
                                deactivateSubsubcuencasLayer();
                            }
                            // También desactiva el límite de comunas si está activo
                            const toggleLimitCommunes = document.getElementById('toggle-limitCommunes');
                            if (toggleLimitCommunes && toggleLimitCommunes.checked) {
                                toggleLimitCommunes.checked = false;
                                if (typeof removeLimitCommunes === 'function') {
                                    removeLimitCommunes();
                                }
                            }
                        }
                    });
                });

                // Inicializar el estado guardado de las cuencas individuales al cargar la página
                cuencaCheckboxes.forEach(cb => {
                    lastCuencasState[cb.id] = cb.checked;
                });

                // Asegurar que el formulario de cuencas se muestre/oculte correctamente al inicio
                if (formCuencas && toggleCuencas) {
                    formCuencas.style.display = toggleCuencas.checked ? 'block' : 'none';
                    // También inicializa las capas en el mapa si 'toggle-cuencas' está marcado al inicio
                    if (toggleCuencas.checked) {
                        cuencaCheckboxes.forEach(cb => {
                            const cuencaKey = cb.getAttribute('data-cuenca');
                            if (cb.checked && cuencasMap[cuencaKey]) {
                                cuencasMap[cuencaKey].addTo(map);
                            }
                        });
                    }
                }
            });

            // ========= Subsubcuencas =========
            let subsubcuencasMap = {};
            const subsubcuencas = [
                subsubcuenca5000,
                subsubcuenca5100,
                subsubcuenca5101,
                subsubcuenca5110,
                subsubcuenca5111,
                subsubcuenca5120,
                subsubcuenca5200,
                subsubcuenca5210,
                subsubcuenca5211,
                subsubcuenca5220,
                subsubcuenca5221,
                subsubcuenca5300,
                subsubcuenca5310,
                subsubcuenca5320,
                subsubcuenca5400,
                subsubcuenca5401,
                subsubcuenca5402,
                subsubcuenca5403,
                subsubcuenca5404,
                subsubcuenca5405,
                subsubcuenca5406,
                subsubcuenca5410,
                subsubcuenca5411,
                subsubcuenca5412,
                subsubcuenca5413,
                subsubcuenca5414,
                subsubcuenca5415,
                subsubcuenca5416,
                subsubcuenca5420,
                subsubcuenca5421,
                subsubcuenca5422,
                subsubcuenca5423,
                subsubcuenca5424,
                subsubcuenca5425,
                subsubcuenca5426,
                subsubcuenca5427,
                subsubcuenca5428,
                subsubcuenca5500,
                subsubcuenca5510,
                subsubcuenca5520,
                subsubcuenca5530,
                //subsubcuenca5601, 
                subsubcuenca5602,
                subsubcuenca5610,
                subsubcuenca5700,
                subsubcuenca5701,
                subsubcuenca5702,
                subsubcuenca5703,
                subsubcuenca5704,
                subsubcuenca5705,
                subsubcuenca5706,
                subsubcuenca5707,
                subsubcuenca5710,
                subsubcuenca5711,
                subsubcuenca5712,
                subsubcuenca5713,
                subsubcuenca5714,
                subsubcuenca5715,
                subsubcuenca5716,
                subsubcuenca5717,
                subsubcuenca5720,
                subsubcuenca5721,
                subsubcuenca5722,
                subsubcuenca5723,
                subsubcuenca5730,
                subsubcuenca5731,
                subsubcuenca5732,
                subsubcuenca5733,
                subsubcuenca5734,
                subsubcuenca5735,
                subsubcuenca5736,
                subsubcuenca5737,
                subsubcuenca5740,
                subsubcuenca5741,
                subsubcuenca5742,
                subsubcuenca5743,
                subsubcuenca5744,
                subsubcuenca5745,
                subsubcuenca5746,
                subsubcuenca5747,
                subsubcuenca5748,
                subsubcuenca5800,
                subsubcuenca6000,
                subsubcuenca6001,
                subsubcuenca6002,
                subsubcuenca6003,
                subsubcuenca6004,
                subsubcuenca6005,
                subsubcuenca6006,
                subsubcuenca6007,
                subsubcuenca6008,
                subsubcuenca6009,
                subsubcuenca6010,
                subsubcuenca6011,
                subsubcuenca6012,
                subsubcuenca6013,
                subsubcuenca6014,
                subsubcuenca6015,
                subsubcuenca6016,
                subsubcuenca6017,
                subsubcuenca6018,
                subsubcuenca6019,
                subsubcuenca6020,
                subsubcuenca6021,
                subsubcuenca6022,
                subsubcuenca6023,
                subsubcuenca6024,
                subsubcuenca6025,
                subsubcuenca6026,
                subsubcuenca6027,
                subsubcuenca6028,
                subsubcuenca6030,
                subsubcuenca6031,
                subsubcuenca6032,
                subsubcuenca6033,
                subsubcuenca6034,
                subsubcuenca6035,
                subsubcuenca6036,
                subsubcuenca6037,
                subsubcuenca6038,
                subsubcuenca6040,
                subsubcuenca6041,
                subsubcuenca6042,
                subsubcuenca6043,
                subsubcuenca6044,
                subsubcuenca6045,
                subsubcuenca6050,
                subsubcuenca6051,
                subsubcuenca6052,
                subsubcuenca6053,
                subsubcuenca6054,
                subsubcuenca6055,
                subsubcuenca6056,
            ]



            // ========= Disponibilidad de Hidrogeno =========
            function display_hidrogen_availability() {
                for (var key in hexagonos) {
                    if (hexagonos.hasOwnProperty(key)) {
                        (function (key) {
                            const coor = hexagonos[key]["COORDINATES"];
                            const originalColor = hexagonos[key]["Color"] === 'special' ? 'transparent' : hexagonos[key]["Color"];
                            const hoverColor = 'yellow';

                            let polygon = L.polygon(coor).addTo(map);
                            polygon.key = key;

                            if (hexagonos[key]["Color"] === 'black') {
                                polygon.setStyle({fillColor: 'black', color: 'black', weight: 0.5, opacity: 0, fillOpacity: 0.5});
                            }
                            else {
                                polygon.setStyle({fillColor: originalColor, color: originalColor, weight: 0, fillOpacity: 0.5});
                            }

                            polygon.on('mouseover', function (e) {
                                const coordDisplay = document.getElementById("coordValue").textContent = JSON.stringify(coor[0]);
                                this.setStyle({
                                    fillColor: hoverColor,
                                    color: hoverColor,
                                    weight: 0,
                                    opacity: 0,
                                    fillOpacity: 0.5
                                });
                            }
                            );

                            polygon.on('mouseout', function (e) {
                                this.setStyle({
                                    fillColor: originalColor,
                                    color: originalColor,
                                    weight: 0,
                                    opacity: 0,
                                    fillOpacity: 0.5
                                });

                            });

                            polygon.on('click', function (e) {
                                const msg = 'Inhabilita';
                                const hex = hexagonos[key];

                                const snaspe = document.querySelector('#valor-snaspe');
                                if (isNaN(hex['distancia a snaspe (km)'])) {
                                    snaspe.innerText = msg;
                                    snaspe.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    snaspe.parentElement.toggleAttribute('data-invalid', false);
                                    snaspe.innerText = parseFloat(hex['distancia a snaspe (km)']).toFixed(2);
                                }

                                const ave = document.querySelector('#valor-ave');
                                if (isNaN(hex['distancia a ave (km)'])) {
                                    ave.innerText = msg;
                                    ave.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    ave.parentElement.toggleAttribute('data-invalid', false);
                                    ave.innerText = parseFloat(hex['distancia a ave (km)']).toFixed(2);
                                }

                                const humedal = document.querySelector('#valor-humedal');
                                if (isNaN(hex['distancia a humedal (km)'])) {
                                    humedal.innerText = msg;
                                    humedal.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    humedal.parentElement.toggleAttribute('data-invalid', false);
                                    humedal.innerText = parseFloat(hex['distancia a humedal (km)']).toFixed(2);
                                }

                                const patrimonioMundial = document.querySelector('#valor-patrimonioMundial');
                                if (isNaN(hex['distancia a patrimonio mundial (km)'])) {
                                    patrimonioMundial.innerText = msg;
                                    patrimonioMundial.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    patrimonioMundial.parentElement.toggleAttribute('data-invalid', false);
                                    patrimonioMundial.innerText = parseFloat(hex['distancia a patrimonio mundial (km)']).toFixed(2);
                                }

                                const monumentoNacional = document.querySelector('#valor-monumentoNacional');
                                if (isNaN(hex['distancia a monumento nacional (km)'])) {
                                    monumentoNacional.innerText = msg;
                                    monumentoNacional.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    monumentoNacional.parentElement.toggleAttribute('data-invalid', false);
                                    monumentoNacional.innerText = parseFloat(hex['distancia a monumento nacional (km)']).toFixed(2);
                                }

                                const santuarioNatural = document.querySelector('#valor-santuarioNatural');
                                if (isNaN(hex['distancia a zona tipica y santuario natural (km)'])) {
                                    santuarioNatural.innerText = msg;
                                    santuarioNatural.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    santuarioNatural.parentElement.toggleAttribute('data-invalid', false);
                                    santuarioNatural.innerText = parseFloat(hex['distancia a zona tipica y santuario natural (km)']).toFixed(2);
                                }

                                const redVial = document.querySelector('#valor-redVial');
                                if (isNaN(hex['distancia a red vial(km)'])) {
                                    redVial.innerText = msg;
                                    redVial.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    redVial.parentElement.toggleAttribute('data-invalid', false);
                                    redVial.innerText = parseFloat(hex['distancia a red vial(km)']).toFixed(2);
                                }
                                const costa = document.querySelector('#valor-costa');
                                if (isNaN(hex['distancia a costa(km)'])) {
                                    costa.innerText = msg;
                                    costa.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    costa.parentElement.toggleAttribute('data-invalid', false);
                                    costa.innerText = parseFloat(hex['distancia a costa(km)']).toFixed(2);
                                }
                                const terminal = document.querySelector('#valor-terminal');
                                if (isNaN(hex['distancia a terminal(km)'])) {
                                    terminal.innerText = msg;
                                    terminal.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    terminal.parentElement.toggleAttribute('data-invalid', false);
                                    terminal.innerText = parseFloat(hex['distancia a terminal(km)']).toFixed(2);
                                }
                                const poblacion = document.querySelector('#valor-poblacion');
                                if (isNaN(hex['distancia a poblacion'])) {
                                    poblacion.innerText = msg;
                                    poblacion.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    poblacion.parentElement.toggleAttribute('data-invalid', false);
                                    poblacion.innerText = parseFloat(hex['distancia a poblacion']).toFixed(2);
                                }
                                const rti = document.querySelector('#valor-rti');
                                if (isNaN(hex['RTI (m)'])) {
                                    rti.innerText = msg;
                                    rti.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    rti.parentElement.toggleAttribute('data-invalid', false);
                                    rti.innerText = parseFloat(hex['RTI (m)']).toFixed(2);
                                }
                                const pvout = document.querySelector('#valor-pvout');
                                if (isNaN(hex['potencia solar (MW)'])) {
                                    pvout.innerText = msg;
                                    pvout.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    pvout.parentElement.toggleAttribute('data-invalid', false);
                                    pvout.innerText = parseFloat(hex['potencia solar (MW)']).toFixed(2);
                                }
                                const potenciaEolica = document.querySelector('#valor-potenciaEolica');
                                if (isNaN(hex['potencia eólica (MW)'])) {
                                    potenciaEolica.innerText = msg;
                                    potenciaEolica.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    potenciaEolica.parentElement.toggleAttribute('data-invalid', false);
                                    potenciaEolica.innerText = parseFloat(hex['potencia eólica (MW)']).toFixed(2);
                                }
                                const hidrogeno = document.querySelector('#valor-hidrogeno');
                                if (isNaN(hex['Hidrogeno (kgH_2/kWp)'])) {
                                    hidrogeno.innerText = msg;
                                    hidrogeno.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    hidrogeno.parentElement.toggleAttribute('data-invalid', false);
                                    hidrogeno.innerText = parseFloat(hex['Hidrogeno (kgH_2/kWp)']).toFixed(2);
                                }
                                const hidrogenoM2 = document.querySelector('#valor-hidrogenoM2');
                                if (isNaN(hex['Hidrogeno (kgH_2/m_2)'])) {
                                    hidrogenoM2.innerText = msg;
                                    hidrogenoM2.parentElement.toggleAttribute('data-invalid', true);
                                }
                                else {
                                    hidrogenoM2.parentElement.toggleAttribute('data-invalid', false);
                                    hidrogenoM2.innerText = parseFloat(hex['Hidrogeno (kgH_2/m_2)']).toFixed(2);
                                }

                                document.getElementById('section-indicadores').toggleAttribute('data-visible', true);
                                const menus = document.querySelectorAll('#menu-hidrico, #menu-opciones, #section-detalle');
                                menus.forEach((m) => {
                                    m.toggleAttribute('data-visible', false);
                                });
                                if (hexagonos[e.target.key]["Color"] === 'black') {
                                    document.getElementById('alert-notMeet').toggleAttribute('data-visible', true);
                                    setTimeout(() => {
                                        document.getElementById('alert-notMeet').toggleAttribute('data-visible', false);
                                    }, 4000);
                                }
                            });
                        })(key);
                    }
                }

            };

            // ========= Markers =========
            let cityPin = L.icon({
                iconUrl: './img/icon/pin.png',
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });
            let industrialPin = L.icon({
                iconUrl: './img/icon/factory_pin.png',
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });

            let ptasPin = L.icon({
                iconUrl: './img/icon/water.png',
                iconSize: [32, 32],
                iconAnchor: [16, 32],
                popupAnchor: [0, -32]
            });
            const communesMarkers = [];
            const desalinationMarkers = [];

            function display_communes_marker() {
                for (let key in markers) {
                    if (markers.hasOwnProperty(key)) {
                        const coordinates = markers[key]["Coordinates"][0];
                        const marker = L.marker([coordinates[0], coordinates[1]], {icon: cityPin}).addTo(map);
                        communesMarkers.push(marker);
                        marker.bindTooltip(key, {permanent: true, direction: 'right'}).openTooltip();
                    }
                }
            };

            function loadDesalinationMarker() {
                for (let plantKey in desaladoras) {
                    if (desaladoras.hasOwnProperty(plantKey)) {
                        let coordinates = desaladoras[plantKey]["coordinates"];
                        const marker = L.marker([coordinates[0], coordinates[1]], {icon: industrialPin});
                        desalinationMarkers.push(marker);
                        marker.name = plantKey
                        marker.bindTooltip(plantKey, {permanent: true, direction: 'right'}).openTooltip();

                        marker.on('click', (event) => {
                            const selectElement = document.getElementById('select-desaladoras');
                            const sectionDesaladoras = document.getElementById('section-desaladoras');
                            selectElement.value = event.target.name;
                            selectElement.dispatchEvent(new Event('change'));
                            sectionDesaladoras.toggleAttribute('data-visible', true);
                        });
                    }
                }
            }
            const ptasMarkers = []
            function loadPtasMarker() {
                for (let key in ptas) {
                    if (ptas.hasOwnProperty(key)) {
                        const marker = L.marker([ptas[key].lat, ptas[key].lon], {icon: ptasPin});
                        ptasMarkers.push(marker);
                        marker.name = key;
                        marker.technology = ptas[key].technology;
                        marker.flowRate = ptas[key].flowRate;
                        marker.commune = ptas[key].commune;

                        marker.on('click', (event) => {
                            const sectionPtas = document.getElementById('section-ptas');
                            document.getElementById('ptas-name').innerText = event.target.name;
                            document.getElementById('ptas-technology').innerText = event.target.technology;
                            document.getElementById('ptas-flowRate').innerText = event.target.flowRate;
                            sectionPtas.toggleAttribute('data-visible', true);
                        });
                    }
                }
            }
            const toggleMarkers = (markers, show) => {
                markers.forEach(marker => {
                    show ? marker.addTo(map) : map.removeLayer(marker);
                });
            }

            window.onload = function () {
                loadCuencas();
                loadSubcuencas();
                loadSubsubcuencas();
                loadPtasMarker();

                display_communes_marker();
                display_hidrogen_availability();
                loadDesalinationMarker();

                map.whenReady(() => {
                    document.getElementById("spinner-container").style.display = "none";
                });

                let pointedMarker;
                map.on('click', (e) => {
                    if (pointedMarker) {
                        map.removeLayer(pointedMarker);
                    }
                    const coor = e.latlng;
                    console.log(coor)
                    pointedMarker = L.marker(coor).addTo(map);
                })

                map.on('mousemove', function (e) {
                    const latlng = e.latlng;
                    const coordDisplay = document.getElementById("coordValue");
                    const a = "[" + latlng.lat + ", " + latlng.lng + "]";
                    coordDisplay.textContent = a;
                });

            }
        </script>
    </div>
</body>

</html>
